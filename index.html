<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ì˜¤ëŠ˜ì˜ ìê¸°ê¸°ë¡</title>
    <style>
        /* í°íŠ¸ ë° ê¸°ë³¸ ì„¤ì • */
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap');

        :root {
            --primary-color: #6a7ba2; /* ì£¼ìš” ìƒ‰ìƒ: ë„¤ì´ë¹„ */
            --secondary-color: #7ec8e3; /* ë³´ì¡° ìƒ‰ìƒ: ìŠ¤ì¹´ì´ë¸”ë£¨ */
            --background-color: #f8f8fa; /* ë°°ê²½ìƒ‰ */
            --card-background: #FFFFFF;
            --text-color: #333;
            --border-color: #ddd;
            --shadow-color: rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
        }

        .container {
            max-width: 900px; /* ì „ì²´ ë„ˆë¹„ í™•ì¥ */
            margin: 40px auto;
            padding: 20px;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
        }

        header h1 {
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        /* í¼ ì„¹ì…˜ ìŠ¤íƒ€ì¼ */
        #record-form {
            background-color: var(--card-background);
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 15px var(--shadow-color);
            margin-bottom: 40px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--primary-color);
            font-size: 1.1em;
        }

        input[type="text"], select, textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 1rem;
            font-family: 'Noto Sans KR', sans-serif;
            box-sizing: border-box;
        }
        
        .hint {
            font-size: 0.8rem;
            color: #999;
            margin-top: 5px;
        }

        /* ê¸°ë¶„ ì„ íƒ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .mood-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .mood-selector input[type="radio"] {
            display: none;
        }

        .mood-selector label {
            padding: 10px 18px;
            border: 2px solid var(--border-color);
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.25s ease;
            font-weight: 500;
            user-select: none;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }

        .mood-selector input[type="radio"]:checked + label {
            background-color: var(--secondary-color);
            color: white;
            border-color: var(--secondary-color);
            font-weight: 700;
            transform: scale(1.05);
        }

        button[type="submit"] {
            width: 100%;
            padding: 15px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        button[type="submit"]:hover {
            background-color: #55668c;
        }

        /* ğŸ“ ê¸°ë¡ ëª©ë¡ ì„¹ì…˜ (í‘œ ìŠ¤íƒ€ì¼) */
        .records-section {
            background-color: var(--card-background);
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 15px var(--shadow-color);
        }
        
        .records-section h2 {
            text-align: center;
            color: var(--primary-color);
            margin-bottom: 20px;
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 10px;
            font-size: 1.5em;
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        #export-excel {
            padding: 8px 15px;
            background-color: var(--secondary-color);
            color: var(--text-color);
            border: none;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        /* í‘œ ê·¸ë¦¬ë“œ ë ˆì´ì•„ì›ƒ */
        .records-header, .record-row {
            display: grid;
            /* ë‹‰ë„¤ì„/ì ìˆ˜/ê¸°ë¶„/ë‹¨ì–´/ìš”ì•½/ì¹­ì°¬/ë„ì›€ */
            grid-template-columns: 80px 50px 80px 100px 1fr 1fr 1fr;
            gap: 5px;
            padding: 10px 5px;
            align-items: center;
            font-size: 0.85rem;
        }

        .records-header {
            font-weight: 700;
            background-color: #f0f0ff; /* í—¤ë” ë°°ê²½ìƒ‰ */
            border-bottom: 2px solid var(--primary-color);
            border-top: 2px solid var(--primary-color);
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .record-row {
            border-bottom: 1px dashed var(--border-color);
        }

        .record-row:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        .record-row:hover {
            background-color: #eef2f9;
        }

        .records-header > div, .record-row > div {
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            padding: 0 5px;
        }
        
        /* ë‹‰ë„¤ì„, ì ìˆ˜, ê¸°ë¶„ì€ ì¤‘ì•™ ì •ë ¬ */
        .record-row .record-nickname,
        .record-row .record-score,
        .record-row .record-mood {
            text-align: center;
        }

        .record-row .record-mood {
            font-size: 1.2rem;
        }


        footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
            font-size: 0.9rem;
            color: #757575;
        }

        /* ëª¨ë°”ì¼ ë°˜ì‘í˜• (í‘œë¥¼ ì¹´ë“œë¡œ ë³€í™˜) */
        @media (max-width: 600px) {
            .records-header {
                display: none;
            }
            .record-row {
                grid-template-columns: 1fr;
                gap: 5px;
                margin-bottom: 15px;
                padding: 15px;
                border: 1px solid var(--border-color);
                border-radius: 10px;
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            }
            .record-row > div {
                white-space: normal;
                padding: 0;
            }
            .record-row > div::before {
                content: attr(data-label) ": ";
                font-weight: bold;
                color: var(--primary-color);
                margin-right: 5px;
            }
            .record-summary, .record-praise, .record-helpful {
                 /* ê¸´ í…ìŠ¤íŠ¸ëŠ” í°íŠ¸ í¬ê¸°ë¥¼ ì¡°ê¸ˆ ì¤„ì—¬ ê°€ë…ì„± í™•ë³´ */
                font-size: 0.9rem; 
            }
            /* ëª¨ë°”ì¼ì—ì„œ ë²„íŠ¼ì´ ê²¹ì¹˜ì§€ ì•Šë„ë¡ */
            .section-header {
                flex-direction: column;
                align-items: stretch;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ë‚˜ì˜ í•˜ë£¨ ë¦¬í¬íŠ¸</h1>
            <p>ì˜¤ëŠ˜ì˜ ë‚˜ë¥¼ ê°ê´€ì Â·ê°ì •ì ìœ¼ë¡œ ê¸°ë¡í•´ë³´ì„¸ìš”.</p>
        </header>

        <main>
            <form id="record-form">
                <!-- 1. ì˜¤ëŠ˜ì˜ ì¹­ì°¬ ì ìˆ˜ -->
                <div class="form-group">
                    <label for="score">1ï¸âƒ£ ì˜¤ëŠ˜ì˜ ë‚˜ì˜ ì¹­ì°¬ ì ìˆ˜ëŠ”?</label>
                    <select id="score" name="score" required>
                        <option value="">ì ìˆ˜ë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
                        <!-- ì ìˆ˜ ì˜µì…˜ì´ ìŠ¤í¬ë¦½íŠ¸ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
                    </select>
                </div>

                <!-- 2. ì˜¤ëŠ˜ì˜ ê¸°ë¶„ -->
                <div class="form-group">
                    <label>2ï¸âƒ£ ì˜¤ëŠ˜ì˜ ë‚˜ì˜ ê¸°ë¶„ì€?</label>
                    <div class="mood-selector">
                        <input type="radio" id="mood1" name="mood" value="í¸ì•ˆ" checked/>
                        <label for="mood1">ğŸ˜Œ í¸ì•ˆ</label>

                        <input type="radio" id="mood2" name="mood" value="ê¸°ì¨" />
                        <label for="mood2">â˜ºï¸ ê¸°ì¨</label>

                        <input type="radio" id="mood3" name="mood" value="ë³´í†µ" />
                        <label for="mood3">ğŸ«¤ ë³´í†µ</label>

                        <input type="radio" id="mood4" name="mood" value="í™”ë‚¨" />
                        <label for="mood4">ğŸ˜¤ í™”ë‚¨</label>

                        <input type="radio" id="mood5" name="mood" value="ìŠ¬í””" />
                        <label for="mood5">ğŸ˜¢ ìŠ¬í””</label>
                    </div>
                    <p class="hint">â€» ì ìˆ˜(1ë²ˆ)ëŠ” â€˜ì´ì„±ì  í‰ê°€â€™, ê¸°ë¶„ì€ â€˜ê°ì •ì  ìƒíƒœâ€™ë¥¼ í‘œí˜„í•©ë‹ˆë‹¤.</p>
                </div>

                <!-- 3. ì˜¤ëŠ˜ì˜ ë‹¨ì–´ -->
                <div class="form-group">
                    <label for="word">3ï¸âƒ£ ì˜¤ëŠ˜ í•˜ë£¨ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ë‹¨ì–´ í•˜ë‚˜</label>
                    <input
                        type="text"
                        id="word"
                        name="word"
                        maxlength="20"
                        placeholder="ì˜ˆ: ì°¨ë¶„í•¨, ì„±ì·¨ê°, ì§€ì¹¨"
                        required
                    />
                </div>

                <!-- 4. ì˜¤ëŠ˜ì˜ í•œ ì¤„ ìš”ì•½ -->
                <div class="form-group">
                    <label for="summary">4ï¸âƒ£ ì˜¤ëŠ˜ ë‚˜ì— ëŒ€í•œ í•œ ì¤„ ìš”ì•½</label>
                    <input
                        type="text"
                        id="summary"
                        name="summary"
                        maxlength="30"
                        placeholder="ì˜ˆ: ì˜¤ëŠ˜ë„ ê´œì°®ì•˜ì–´"
                        required
                    />
                </div>

                <!-- 5. ì¹­ì°¬ê³¼ ê²©ë ¤ -->
                <div class="form-group">
                    <label for="praise">5ï¸âƒ£ ì˜¤ëŠ˜ì˜ ë‚˜ì—ê²Œ í•´ì£¼ê³  ì‹¶ì€ ì¹­ì°¬ê³¼ ê²©ë ¤ í•œë§ˆë””</label>
                    <textarea
                        id="praise"
                        name="praise"
                        rows="3"
                        placeholder="ì˜¤ëŠ˜ ë‚´ê°€ ì˜í•œ ì ì€ ___ì´ë‹¤."
                    ></textarea>
                </div>

                <!-- 6. ë„ì›€ì´ ë˜ì—ˆë˜ í–‰ë™/ìƒê° -->
                <div class="form-group">
                    <label for="helpful">6ï¸âƒ£ ë‚˜ì—ê²Œ ë„ì›€ì´ ë˜ì—ˆë˜ í–‰ë™ì´ë‚˜ ìƒê°ì´ ìˆë‹¤ë©´ ê³µìœ í•´ ì£¼ì„¸ìš”</label>
                    <textarea
                        id="helpful"
                        name="helpful"
                        rows="3"
                        placeholder="ì˜ˆ: ì‚°ì±…í•˜ë©´ì„œ ë¨¸ë¦¬ê°€ ë§‘ì•„ì¡Œì–´ìš”."
                    ></textarea>
                </div>

                <!-- 7. ë‹‰ë„¤ì„ -->
                <div class="form-group">
                    <label for="nickname">7ï¸âƒ£ ë‹‰ë„¤ì„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”</label>
                    <input
                        type="text"
                        id="nickname"
                        name="nickname"
                        maxlength="10"
                        placeholder="ì˜ˆ: ìµëª…ì˜ í•™ìƒ"
                        required
                    />
                </div>

                <button type="submit">ê¸°ë¡í•˜ê¸°</button>
            </form>

            <!-- ğŸ“ ê¸°ë¡ ëª©ë¡ ì„¹ì…˜ -->
            <section class="records-section">
                <div class="section-header">
                    <h2>ìš°ë¦¬ì˜ ê¸°ë¡ë“¤</h2>
                    <button id="export-excel">ì—‘ì…€ë¡œ ë‚´ë³´ë‚´ê¸°</button>
                </div>
                <div class="records-list-container">
                    <!-- í‘œ í—¤ë” (Apps Scriptì˜ í—¤ë” ìˆœì„œì™€ ì¼ì¹˜í•˜ë„ë¡ ë°°ì¹˜ë¨) -->
                    <div class="records-header">
                        <div>ë‹‰ë„¤ì„</div>
                        <div>ì ìˆ˜</div>
                        <div>ê¸°ë¶„</div>
                        <div>ë‹¨ì–´</div>
                        <div>ìš”ì•½</div>
                        <div>ì¹­ì°¬/ê²©ë ¤</div>
                        <div>ë„ì›€ëœì </div>
                    </div>
                    <div id="records-container">
                        <!-- ê¸°ë¡ ëª©ë¡ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤. -->
                    </div>
                </div>
            </section>

        </main>

        <footer>
            <p>&copy; 2025 ë‚˜ì˜ í•˜ë£¨ ë¦¬í¬íŠ¸. All rights reserved.</p>
        </footer>
    </div>
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // âœ… ìµœì¢… ë°°í¬ URL ë°˜ì˜
            // ì´ ë¶€ë¶„ì„ ìƒˆë¡œ ë°°í¬í•œ Apps Script URLë¡œ ë³€ê²½í•´ ì£¼ì„¸ìš”!
            const WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbzOR6HRKpg3cucLcjAChGDkvOSUigb0vwASeRlhbVseSedcT6KxtXLXhSKTmVkqNepX/exec'; 

            // 10ì ë¶€í„° 100ì ê¹Œì§€ì˜ ì˜µì…˜ ì¶”ê°€ (ìŠ¤í¬ë¦½íŠ¸ë¡œ ìƒì„±)
            const scoreSelect = document.getElementById('score');
            
            // ê¸°ì¡´ì˜ for ë£¨í”„ì™€ ìˆ˜ë™ ì˜µì…˜ì„ ì œê±°í•˜ê³ , 10ë¶€í„° 100ê¹Œì§€ 10ì  ë‹¨ìœ„ë¡œ ëª¨ë‘ ìƒì„±í•©ë‹ˆë‹¤.
            for (let i = 10; i <= 100; i += 10) {
                const option = document.createElement('option');
                option.value = i;
                option.textContent = `${i}ì `;
                scoreSelect.appendChild(option);
            }
            
            const recordForm = document.getElementById('record-form');
            const recordsContainer = document.getElementById('records-container');
            const exportButton = document.getElementById('export-excel');
            let recordsCache = []; // ë°ì´í„° ìºì‹±

            // DOMì— ê¸°ë¡ ëª©ë¡ í–‰ ì¶”ê°€
            const addRecordToDOM = (record) => {
                const row = document.createElement('div');
                row.classList.add('record-row');

                const moodEmojis = { 
                    'í¸ì•ˆ': 'ğŸ˜Œ', 'ê¸°ì¨': 'â˜ºï¸', 'ë³´í†µ': 'ğŸ«¤', 'í™”ë‚¨': 'ğŸ˜¤', 'ìŠ¬í””': 'ğŸ˜¢' 
                };
                
                // Apps Scriptì˜ í—¤ë”ì™€ ì¼ì¹˜í•˜ëŠ” í‚¤ ì‚¬ìš© (ëŒ€ë¬¸ì ì£¼ì˜: Nickname, Score, Mood ë“±)
                row.innerHTML = `
                    <div class="record-nickname" data-label="ë‹‰ë„¤ì„">${record.Nickname || ''}</div>
                    <div class="record-score" data-label="ì ìˆ˜">${record.Score || ''}</div>
                    <div class="record-mood" data-label="ê¸°ë¶„">${moodEmojis[record.Mood] || record.Mood || ''}</div>
                    <div class="record-word" data-label="ë‹¨ì–´" title="${record.Word || ''}">${record.Word || ''}</div>
                    <div class="record-summary" data-label="ìš”ì•½" title="${record.Summary || ''}">${record.Summary || ''}</div>
                    <div class="record-praise" data-label="ì¹­ì°¬/ê²©ë ¤" title="${record.Praise || ''}">${record.Praise || ''}</div>
                    <div class="record-helpful" data-label="ë„ì›€ëœì " title="${record.Helpful || ''}">${record.Helpful || ''}</div>
                `;
                recordsContainer.prepend(row); // ìµœì‹  í•­ëª©ì„ ê°€ì¥ ìœ„ì— ì¶”ê°€
            };

            // ë°ì´í„° ë¡œë“œ ë° í™”ë©´ ì—…ë°ì´íŠ¸
            const loadRecords = async () => {
                recordsContainer.innerHTML = '<div style="text-align: center; padding: 20px;">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>';
                try {
                    const response = await fetch(WEB_APP_URL, { method: 'GET' });
                    
                    if (!response.ok) {
                         const errorText = await response.text();
                         console.error("Apps Script Error Response:", errorText);
                         throw new Error(`ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨: ${response.statusText}`);
                    }
                    
                    recordsCache = await response.json();

                    if (!Array.isArray(recordsCache)) {
                        console.error("Error data received:", recordsCache);
                        throw new Error('Google Apps Scriptì—ì„œ ìœ íš¨í•˜ì§€ ì•Šì€ ë°ì´í„°ê°€ ìˆ˜ì‹ ë˜ì—ˆìŠµë‹ˆë‹¤. ì‹œíŠ¸/í—¤ë” ì„¤ì •ì„ í™•ì¸í•˜ì„¸ìš”.');
                    }
                    
                    // Timestamp ê¸°ì¤€ìœ¼ë¡œ ìµœì‹ ìˆœ ì •ë ¬
                    // Apps Scriptì—ì„œ ì²« ë²ˆì§¸ í—¤ë”ê°€ "Timestamp" (ëŒ€ë¬¸ì T)ì¸ì§€ í™•ì¸í•˜ì„¸ìš”.
                    recordsCache.sort((a, b) => new Date(b.Timestamp) - new Date(a.Timestamp));
                    
                    recordsContainer.innerHTML = ''; 
                    if (recordsCache.length === 0) {
                         recordsContainer.innerHTML = '<div style="text-align: center; padding: 20px; color: #777;">ì•„ì§ ê¸°ë¡ëœ ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤.</div>';
                    } else {
                        recordsCache.forEach(addRecordToDOM);
                    }

                } catch (error) {
                    console.error('Error loading records:', error);
                    // ì˜¤ë¥˜ ë©”ì‹œì§€ ì°½ ëŒ€ì‹  ì¸ë¼ì¸ ë©”ì‹œì§€ë¡œ í‘œì‹œ
                    const errorMessage = error.message.includes('Sheet not found') 
                        ? 'âš ï¸ ì‹œíŠ¸ ì´ë¦„ì„ í™•ì¸í•˜ê±°ë‚˜ ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ì ‘ê·¼ ê¶Œí•œì„ í™•ì¸í•˜ì„¸ìš”.' 
                        : `ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨: ${error.message}`;

                    recordsContainer.innerHTML = `<div style="color: red; padding: 20px; text-align: center;">${errorMessage}</div>`;
                }
            };

            // í¼ ì œì¶œ ì´ë²¤íŠ¸ ì²˜ë¦¬
            recordForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const submitButton = e.target.querySelector('button[type="submit"]');
                submitButton.disabled = true;
                submitButton.textContent = 'ì €ì¥ ì¤‘...';

                const formData = new FormData(recordForm);
                // POST ë°ì´í„°ì˜ í‚¤ëŠ” Apps Scriptì˜ doPost í•¨ìˆ˜ ë‚´ë¶€ ë³€ìˆ˜ëª…ê³¼ ì¼ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤.
                const data = {
                    score: formData.get('score'),
                    mood: formData.get('mood'),
                    word: formData.get('word'),
                    summary: formData.get('summary'),
                    praise: formData.get('praise'),
                    helpful: formData.get('helpful'),
                    nickname: formData.get('nickname')
                };

                try {
                    const response = await fetch(WEB_APP_URL, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(data)
                    });
                    
                    if (!response.ok) {
                        throw new Error('Apps Scriptì—ì„œ ì˜¤ë¥˜ ì‘ë‹µì„ ë°›ì•˜ìŠµë‹ˆë‹¤. (HTTP ìƒíƒœ ì½”ë“œ ì˜¤ë¥˜)');
                    }

                    const result = await response.json();
                    if (result.status === 'error') {
                         throw new Error(result.message);
                    }
                    
                    // ì„±ê³µ ë©”ì‹œì§€ ë¡œê·¸ ì¶œë ¥
                    console.log('âœ… ì„±ê³µì ìœ¼ë¡œ ê¸°ë¡ë˜ì—ˆìŠµë‹ˆë‹¤. ë°ì´í„°ë¥¼ ìƒˆë¡œê³ ì¹¨í•©ë‹ˆë‹¤.', result);
                    
                    recordForm.reset();
                    document.getElementById('mood1').checked = true; // ê¸°ë¶„ ì´ˆê¸°í™”

                    // ë°ì´í„° ìºì‹œ ë° ëª©ë¡ ìƒˆë¡œê³ ì¹¨ (ì„œë²„ì—ì„œ ìµœì‹  ë°ì´í„° ë¡œë“œ)
                    loadRecords(); 

                } catch (error) {
                    console.error('Error submitting record:', error);
                    // alert() ëŒ€ì‹  ì»¤ìŠ¤í…€ ë©”ì‹œì§€ ì‚¬ìš©
                    const errorMessage = `âŒ ê¸°ë¡ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. Apps Scriptì˜ ë¡œê·¸ë¥¼ í™•ì¸í•˜ì„¸ìš”. (${error.message})`;
                    alert(errorMessage); 
                } finally {
                    submitButton.disabled = false;
                    submitButton.textContent = 'ê¸°ë¡í•˜ê¸°';
                }
            });

            // ì—‘ì…€ ë‚´ë³´ë‚´ê¸° ì´ë²¤íŠ¸ ì²˜ë¦¬
            exportButton.addEventListener('click', () => {
                if (recordsCache.length === 0) {
                    alert('ë‚´ë³´ë‚¼ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }
                
                // ë‚´ë³´ë‚¼ í•„ë“œ ìˆœì„œì™€ í•œê¸€ í—¤ë” ì •ì˜
                const exportData = recordsCache.map(record => {
                    return {
                        'ê¸°ë¡ì‹œê°„': record.Timestamp, // Apps Scriptì—ì„œ ê°€ì ¸ì˜¨ ë°ì´í„° í‚¤ë¥¼ ì‚¬ìš©
                        'ë‹‰ë„¤ì„': record.Nickname,
                        'ì ìˆ˜': record.Score,
                        'ê¸°ë¶„': record.Mood,
                        'ë‹¨ì–´': record.Word,
                        'ìš”ì•½': record.Summary,
                        'ì¹­ì°¬/ê²©ë ¤': record.Praise,
                        'ë„ì›€ëœì ': record.Helpful
                    };
                }).filter(r => r['ì ìˆ˜'] !== undefined); // ë°ì´í„°ê°€ ìˆëŠ” ìœ íš¨í•œ í–‰ë§Œ ë‚´ë³´ë‚´ê¸°

                const worksheet = XLSX.utils.json_to_sheet(exportData);
                const workbook = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(workbook, worksheet, "ì¹­ì°¬ê¸°ë¡");
                XLSX.writeFile(workbook, "my_praise_records.xlsx");
            });

            // ì´ˆê¸° ë°ì´í„° ë¡œë“œ
            loadRecords();
        });
    </script>
</body>
</html>
